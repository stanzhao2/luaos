LUA_INC=..\lua-5.4.4\src
LUA_DIR=..\lua-5.4.4\src
LUA_LIBDIR=..\lua-5.4.4
LUA_LIB=..\lua-5.4.4\src\lua54.lib

T=sqlite3

DRIVER_INCLUDE= /I".\libs\sqlite3"
DRIVER_OBJ=".\libs\sqlite3\sqlite3.obj"

OBJS= src\luasql.obj src\ls_$T.obj $(DRIVER_OBJ)

.c.obj:
	cl /c /Fo$@ /O2 /MT /I$(LUA_INC) /DWIN32 /D_CRT_SECURE_NO_DEPRECATE $(DRIVER_INCLUDE) $<

src\$T.dll: $(OBJS)
	link /dll /def:src\$T.def /out:$@ $(OBJS) $(LUA_LIB) 

install:
	IF NOT EXIST "$(LUA_LIBDIR)\luasql" mkdir "$(LUA_LIBDIR)\luasql"
	copy "src\$T.dll" "$(LUA_LIBDIR)\luasql"

clean:
	del src\$T.dll
	del src\$T.exp
	del src\$T.lib
	del $(OBJS)

